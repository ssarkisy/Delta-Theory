# Walkthrough Step 10 — Numerical recipe and stability

Event-aware integration (practical algorithm):

1. Root finding:
   - For each source $o$ (including $o'=o$ for potential self-hits), solve $F(t';t)=\|\mathbf{s}_{o'}(t)-\mathbf{s}_o(t')\|-(t-t')=0$ for $t'\le t$.
   - Discard non-physical roots by convention $H(0)=0$; handle $r=0$ cases by symmetry (no directional acceleration).

2. Per-hit accumulation:
   - For each accepted root, compute $r$, $\hat{\mathbf{r}}$, and
     $$
     \mathbf{a}_{o'\leftarrow o}(t;t')=\kappa\,\sigma_{q_o q_{o'}}\,\frac{|q_o q_{o'}|}{r^2}\,\frac{1}{1+\|\mathbf{v}_o(t')\|}\,\hat{\mathbf{r}}.
     $$
   - Sum over all sources and all roots (superposition).

3. Time stepping:
   - Impulsive mode: advance velocities with jumps at hit times (measure-driven ODE with velocity of bounded variation).
   - Mollified mode: replace $\delta(\cdot)$ by $\delta_\eta(\cdot)$ and integrate with a standard ODE solver; choose $\eta$ small relative to local geometric scales.

4. Stability tips:
   - Use event bracketing or root trackers for continuity of $t'(t)$ across steps.
   - Limit step size so that at most one (or a controlled number of) mollified shells overlap significantly per step.
   - Monitor invariants over resolved windows (work–energy balance with $\Phi_\eta$) to validate settings.

5. Units:
   - Use $v=1$ nondimensionalization throughout. Remember: only the emitter speed modulates per-hit amplitude; receiver speed influences only power via $v_r$.

Plain language: At each time, find which past emissions can reach you now, sum their radial pushes (dimmed by how fast the emitters were moving), and step forward—either with sharp kicks at exact hit times or with tiny-thick shells for smooth integration.
