

**Setup / assumptions**

* The emitter is at position $\mathbf{x}_s(t)$ in 3-D space (it can move).
* The emitter emits **thin spherical shells**. Each shell is created at a single instant $\tau$ and then expands outward **spherically** from the creation point.
* The shell radius after emission time $\tau$ is

  $$
  r(t,\tau) = c\,(t-\tau) \quad \text{for } t\ge\tau,
  $$

  where $c$ is the constant **field speed** (you wrote $dr/dt=$ field speed; I call that $c$).
* Each emitted shell carries a **strength** $Q$ (I’ll call that “shell amplitude” — the physical meaning depends on your application: charge, potential impulse, energy, etc.).
* The emitter makes shells at a constant **time rate** $R$ \[shells per second]. So the *source amplitude per unit time* (strength inserted into the field per second) is of order $q(t)\sim Q\times R$ (exactly $q(t)=\sum_n Q\,\delta(t-\tau_n)$ if shells are discrete impulses at times $\tau_n$; in the limit of many closely spaced shells you may treat $q(t)$ as continuous).
* We want to know the field $\phi(\mathbf{x},t)$ (I’ll call the scalar field “potential” or simply $\phi$) produced at any point $\mathbf{x}$ and time $t$.

I’ll explain **a time-based PDE/source** as well as **a integral / Green’s function / delayed solution** for this setup, define every symbol I use, and show how the expanding shells show up in each method. I’ll highlight how slowing/stopping the emitter is handled.

---

# 1) Time-based PDE (wave equation with a moving point source)

**Physical idea:** keep the source as “something injected per unit time at the emitter location,” put that into the wave PDE that governs how disturbances travel at speed $c$, and let the PDE produce expanding spherical wavefronts automatically. Numerically this is usually the easiest and most robust approach.

### PDE model

Use the scalar wave equation (this is the standard PDE for a field that propagates at finite speed $c$):

$$
\boxed{\;\frac{\partial^2 \phi}{\partial t^2}(\mathbf{x},t) - c^2 \,\nabla^2 \phi(\mathbf{x},t) \;=\; S(\mathbf{x},t)\;}
$$

**Symbols**

* $\phi(\mathbf{x},t)$: scalar field (potential) at position $\mathbf{x}\in\mathbb{R}^3$ and time $t$.
* $c$: field propagation speed (units length/time).
* $\nabla^2$: Laplacian operator in space (sums second spatial derivatives).
* $S(\mathbf{x},t)$: source term (right-hand side) — this is how the emitter injects shells into the field.

### Point (moving) source form

If the emitter injects instantaneous shells of strength $Q$ at times $\tau_n$, a compact way to write the source is

$$
S(\mathbf{x},t) \;=\; \sum_n Q\,\delta\!\big(t-\tau_n\big)\,\delta\!\big(\mathbf{x}-\mathbf{x}_s(\tau_n)\big).
$$

If the shells are produced at constant rate $R$ and are very frequent you can approximate by a continuous source amplitude $q(t)$. For example a continuous steady production of shells each of strength $Q$ at rate $R$ gives an average source per time

$$
q(t) \approx Q\,R \quad\text{(units: field-strength per second)}.
$$

Then you write a smoothed source

$$
S(\mathbf{x},t)= q(t)\,\delta\!\big(\mathbf{x}-\mathbf{x}_s(t)\big).
$$

**How expanding shells appear**

* You did **not** put a “radius” into the right-hand side. Instead, the PDE and the finite speed $c$ cause any instantaneous injection at the point $\mathbf{x}_s(\tau)$ to produce an *outgoing spherical wave* whose wavefront moves outward at speed $c$. That is the built-in behavior of the wave equation.
* For a single impulse $Q\,\delta(t-\tau)\delta(\mathbf{x}-\mathbf{x}_s)$ the analytic 3-D solution is a spherical wave with amplitude $\sim Q/(4\pi r)$ concentrated on the moving shell $r=c(t-\tau)$ (I will show the explicit integral/Green form in Method 2). So **Method 1** is simply the PDE whose solutions are those expanding shells.

**Why $v$ (emitter speed) doesn’t cause blow-ups**

* If the emitter slows or stops, $S(\mathbf{x},t)$ just keeps being nonzero at the same spatial location; the wave equation spreads each injection outward at speed $c$. No $1/|\mathbf{v}|$ singularity appears because you never converted from “per time” to “per distance.” You remain time-based.
* Numerically, represent the point delta by a small, smooth kernel if you want to avoid grid artifacts. Example: instead of $\delta(\mathbf{x}-\mathbf{x}_s)$ use a small Gaussian of width $\sigma$ comparable to grid spacing.

**Numerical recipe (simple)**

* Choose spatial grid $\mathbf{x}_i$ and time step $\Delta t$ satisfying CFL stability (roughly $c\Delta t/\Delta x \le \text{const}$).
* Use a standard finite-difference time stepping for the wave equation (centered difference in time and space).
* At each time step $t_n$ add the source contribution $S(\cdot,t_n)$ to the RHS at the grid cells nearest $\mathbf{x}_s(t_n)$. If the emitter stops, it remains injecting at that grid location — the solver propagates outgoing shells.
* To avoid a numerical spike, spread the delta over a few cells (mollifier) so you physically model a thin shell of finite thickness.

**Summary for Method 1**

* Model is explicit, straightforward, numerically robust.
* Emission is naturally time-based; shells expand automatically at speed $c$.
* No division by the emitter speed appears; stopping the emitter is handled simply by keeping the source at the same location.

---

# 2) Integral (Green’s function / retarded potential) approach

**Physical idea:** instead of evolving a PDE in time, write the solution as the sum of contributions from every past emission. For the wave equation the contribution from an impulse emitted at time $\tau$ and place $\mathbf{x}_s(\tau)$ arrives at a field point $\mathbf{x}$ only at the **retarded time** when the spherical shell reaches $\mathbf{x}$. The Green’s function neatly encodes the expanding shell.

### Fundamental formula (general)

If the wave equation is

$$
\frac{\partial^2 \phi}{\partial t^2} - c^2 \nabla^2 \phi = S(\mathbf{x},t),
$$

then the solution may be written as the space–time convolution with the Green’s function $G$:

$$
\boxed{\;\displaystyle \phi(\mathbf{x},t)
\;=\;
\iint G\big(\mathbf{x},t;\mathbf{y},\tau\big)\;S(\mathbf{y},\tau)\;d\tau\,d^3y\;}
$$

* $G(\mathbf{x},t;\mathbf{y},\tau)$ is the response at $(\mathbf{x},t)$ to an instantaneous unit impulse at $(\mathbf{y},\tau)$.

### The 3-D free-space wave Green’s function

For three spatial dimensions (the usual case for spherical shells), the causal Green’s function is

$$
G(\mathbf{x},t;\mathbf{y},\tau)
\;=\;
\frac{\delta\!\big(t-\tau - \tfrac{|\mathbf{x}-\mathbf{y}|}{c}\big)}{4\pi\,|\mathbf{x}-\mathbf{y}|},
\qquad t>\tau.
$$

**Interpretation:** a unit impulse at location $\mathbf{y}$ and time $\tau$ influences $\mathbf{x}$ at time $t$ only when the travel time $ |\mathbf{x}-\mathbf{y}|/c$ has elapsed; the $1/(4\pi r)$ factor is the usual geometric decay of an outgoing spherical wave in 3D.

### Plugging in a moving point source

If the emitter is a moving point source with a time-dependent source amplitude $q(\tau)$ at location $\mathbf{x}_s(\tau)$, then $S(\mathbf{y},\tau)= q(\tau)\,\delta(\mathbf{y}-\mathbf{x}_s(\tau))$. Plugging this into the convolution gives (integral over $\tau$ only):

$$
\boxed{\;\displaystyle
\phi(\mathbf{x},t) \;=\; \int_{-\infty}^{t}
\frac{q(\tau)\;
\delta\!\big(t-\tau - \tfrac{|\mathbf{x}-\mathbf{x}_s(\tau)|}{c}\big)}
{4\pi\,|\mathbf{x}-\mathbf{x}_s(\tau)|}\; d\tau\;}
$$

* $q(\tau)$ is the instantaneous source amplitude at time $\tau$. In your shell model, if each shell has strength $Q$ and shells occur at times $\{\tau_n\}$, then $q(\tau)=\sum_n Q\,\delta(\tau-\tau_n)$. If the emission is continuous with average rate $R$ and you approximate many shells per second, you might use $q(\tau)\approx Q\,R$ (or some smooth $q(\tau)$).

### Evaluating the integral — the retarded time

The $\delta$-function in the integrand enforces the *retarded-time condition*:

$$
t - \tau = \frac{r(\tau)}{c}, \qquad r(\tau)\equiv |\mathbf{x}-\mathbf{x}_s(\tau)|.
$$

So the contribution to $\phi(\mathbf{x},t)$ comes only from times $\tau$ such that the expanding spherical shell emitted at $\tau$ has just reached $\mathbf{x}$ at time $t$.

Mathematically, use the identity $\delta(g(\tau))=\sum_i \delta(\tau-\tau_i)/|g'(\tau_i)|$ where $\tau_i$ are simple roots of $g$. With $g(\tau)=t-\tau - r(\tau)/c$ we find (after algebra) the standard retarded solution:

$$
\boxed{\;
\phi(\mathbf{x},t) \;=\; \sum_{\tau_i}
\frac{q(\tau_i)}{4\pi\,r(\tau_i)\,\big|1 + \tfrac{1}{c}\,r'(\tau_i)\big|}
\;=\;
\sum_{\tau_i}
\frac{q(\tau_i)}{4\pi\,r(\tau_i)\,\big|1 - \tfrac{\mathbf{n}(\tau_i)\cdot\mathbf{v}_s(\tau_i)}{c}\big|}\;}
$$

where:

* the sum runs over **retarded times** $\tau_i$ solving $t-\tau_i=r(\tau_i)/c$ (usually there is a single relevant root).
* $r(\tau_i)=|\mathbf{x}-\mathbf{x}_s(\tau_i)|$.
* $r'(\tau)=\dfrac{d}{d\tau}|\mathbf{x}-\mathbf{x}_s(\tau)| = -\,\mathbf{n}(\tau)\cdot\mathbf{v}_s(\tau)$.
* $\mathbf{v}_s(\tau)=\dfrac{d\mathbf{x}_s}{d\tau}$ is the source velocity at emission time $\tau$.
* $\mathbf{n}(\tau) = \dfrac{\mathbf{x}-\mathbf{x}_s(\tau)}{r(\tau)}$ is the unit vector pointing from source (at emission) to the field point.

The factor $1 - \mathbf{n}\!\cdot\!\mathbf{v}_s/c$ (in the denominator) is a Doppler/retardation factor: if the source is moving toward the observer ($\mathbf{n}\!\cdot\!\mathbf{v}_s>0$) the denominator is smaller and the observed amplitude is boosted (intuitive: emitted shells catch up); moving away reduces amplitude. This is precisely the same structure that appears in Liénard–Wiechert potentials for moving charges.

### Special simple case — stationary emitter

If $\mathbf{x}_s(\tau)=\mathbf{x}_0$ (emitter fixed) and $q(\tau)=Q\,\delta(\tau-\tau_0)$ (single shell at $\tau_0$), then the formula reduces to the intuitive result:

* The field at $\mathbf{x},t$ is nonzero only when $t-\tau_0 = |\mathbf{x}-\mathbf{x}_0|/c$, i.e., when the spherical shell of radius $r=c(t-\tau_0)$ reaches $\mathbf{x}$.
* The amplitude is $\displaystyle \phi(\mathbf{x},t) = \frac{Q}{4\pi\,r}$ (no extra Jacobian factor because $v_s=0$).

### How shells show up here

* Each emitted shell corresponds to one emission time $\tau$. The delta in the Green’s function selects the observation times $t$ at which the shell reaches $\mathbf{x}$.
* The shape of the contribution is the $1/(4\pi r)$ geometric factor (for wave amplitude); the shell is “thin” in time if $q(\tau)$ is a delta in $\tau$, so you get a short impulse when the wavefront passes.

### Handling an emitter that stops / $|\mathbf v_s|\to 0$

* If the emitter slows or stops, the Jacobian factor $1 - \mathbf{n}\cdot\mathbf{v}_s/c$ tends to 1 and nothing singular happens. The retarded equation still has a solution and each shell arrives at the predicted time.
* If the emitter sits still and emits many shells (continuous $q(\tau)$), the field is the time integral (or sum) of all shell contributions evaluated at their respective retarded times. No $1/|\mathbf{v}_s|$ blowup occurs.

---

# Intuition: when to use which method

* **Method 1 (PDE)**: use this if you want to simulate the whole field over a spatial grid and time — e.g., visualize full 3D field, handle complicated background media (inhomogeneous $c$, damping), or include nonlinearities. Numerically straightforward: step the PDE forward, deposit source each time step. Very robust when the emitter stops or moves.

* **Method 2 (Green’s function / retarded integral)**: use this if you want closed-form expressions, analytic insight, or to compute the field at a few observation points (not the whole grid). This method gives the exact retarded formula and explicitly shows the “shell arrival condition” $t-\tau=|\mathbf{x}-\mathbf{x}_s(\tau)|/c$ and the Doppler-like Jacobian $1-\mathbf{n}\cdot\mathbf{v}_s/c$. For moving emitters it requires solving the retarded-time equation (root finding) for each observation point/time pair — cheaper if you have many emission events but few observers.

---

# Short worked example (stationary emitter, discrete shells)

* Emitter at origin $\mathbf{x}_s=0$. Single shell at time $\tau_0$ with strength $Q$.
* Field at radius $r=|\mathbf{x}|$ and time $t$ is

  $$
  \phi(r,t) = \begin{cases}
  \dfrac{Q}{4\pi r}, & \text{if } t=\tau_0 + r/c \text{ (shell exactly arrives)},\\[6pt]
  0, & \text{otherwise (for an idealized infinitely thin shell)}.
  \end{cases}
  $$
* If you produce shells at rate $R$ (say one every $1/R$ seconds) and each $Q$, then you get a sequence of impulses at times $t=\tau_n + r/c$ whose amplitudes are $Q/(4\pi r)$. If $R$ is large and shells overlap, the observed field becomes more continuous.

---

# Practical implementation tips / numerical cautions

* **Always smear the delta** in numerical work: replace $\delta(\mathbf{x}-\mathbf{x}_s)$ by a small, normalized kernel of width $\sigma$ comparable to your grid spacing. This avoids grid-scale noise and models a physically finite shell thickness.
* **CFL condition** for wave PDE: choose $\Delta t$ so that $c \Delta t/\Delta x$ satisfies the stability bound for your discretization. If violated you'll get numerical instability.
* **Retarded solving (Method 2)** requires root-finding for $\tau$ from $t-\tau = r(\tau)/c$. For slowly moving emitters this is easy (one iteration), but if the source moves fast near $c$ the root finding and the denominator $1-\mathbf{n}\cdot\mathbf{v}_s/c$ require care (causality and relativistic effects arise if $|\mathbf{v}_s|$ approaches $c$).
* **If shells have finite thickness** in time, replace $\delta(t-\tau)$ by a smooth temporal profile. That makes the outgoing wavefront a pulse of finite duration rather than an idealized instant.

---

# Bottom line (in 3 sentences)

* Model the emitter as a **time-based** source of impulses $q(\tau)$ at location $\mathbf{x}_s(\tau)$.
* Method 1 (solve the wave PDE with that source) is the easiest, robust way to get fields on a grid; the wave equation naturally produces expanding spherical shells at speed $c$.
* Method 2 (use the Green’s function / retarded integral) gives an analytic expression: each emission at time $\tau$ produces a contribution at $(\mathbf{x},t)$ only if $t-\tau = |\mathbf{x}-\mathbf{x}_s(\tau)|/c$; the observed amplitude includes the geometric $1/(4\pi r)$ decay and a Doppler/retardation factor $1-\mathbf{n}\cdot\mathbf{v}_s/c$.

---


