

**Setup / assumptions**

* The emitter is at position $\mathbf{x}_s(t)$ in 3-D space (it can move).
* The emitter emits **thin spherical shells**. Each shell is created at a single instant $\tau$ and then expands outward **spherically** from the creation point.
* The shell radius after emission time $\tau$ is

  $$
  r(t,\tau) = c\,(t-\tau) \quad \text{for } t\ge\tau,
  $$

  where $c$ is the constant **field speed** (you wrote $dr/dt=$ field speed; I call that $c$).
* Each emitted shell carries a **strength** $Q$ (I’ll call that “shell amplitude” — the physical meaning depends on your application: charge, potential impulse, energy, etc.).
* Continuous source (preferred): model the emitter as a moving point injection with time-density $q(t)$ (amplitude per unit time) at its instantaneous position, i.e., $S(\mathbf{x},t)=q(t)\,\delta\!\big(\mathbf{x}-\mathbf{x}_s(t)\big)$. Each instant $t_0$ contributes a spherical shell; we do not count “shells per second” (pulse trains are merely numerical surrogates).
* We want to know the field $\phi(\mathbf{x},t)$ (I’ll call the scalar field “potential” or simply $\phi$) produced at any point $\mathbf{x}$ and time $t$.

I’ll explain **a time-based PDE/source** as well as **a integral / Green’s function / delayed solution** for this setup, define every symbol I use, and show how the expanding shells show up in each method. I’ll highlight how slowing/stopping the emitter is handled.

---

# 1) Time-based PDE (wave equation with a moving point source)

**Physical idea:** keep the source as “something injected per unit time at the emitter location,” put that into the wave PDE that governs how disturbances travel at speed $c$, and let the PDE produce expanding spherical wavefronts automatically. Numerically this is usually the easiest and most robust approach.

### PDE model

Use the scalar wave equation (this is the standard PDE for a field that propagates at finite speed $c$):

$$
\boxed{\;\frac{\partial^2 \phi}{\partial t^2}(\mathbf{x},t) - c^2 \,\nabla^2 \phi(\mathbf{x},t) \;=\; S(\mathbf{x},t)\;}
$$

**Symbols**

* $\phi(\mathbf{x},t)$: scalar field (potential) at position $\mathbf{x}\in\mathbb{R}^3$ and time $t$.
* $c$: field propagation speed (units length/time).
* $\nabla^2$: Laplacian operator in space (sums second spatial derivatives).
* $S(\mathbf{x},t)$: source term (right-hand side) — this is how the emitter injects shells into the field.

### Point (moving) source form

Use a continuous time-density of emission at the moving point:

$$
S(\mathbf{x},t) \;=\; q(t)\,\delta\!\big(\mathbf{x}-\mathbf{x}_s(t)\big).
$$

Here $q(t)$ has units “amplitude per unit time.” The finite-speed wave operator then generates outgoing spherical wavefronts automatically; no discrete shell count is assumed.

**How expanding shells appear**

* You did **not** put a “radius” into the right-hand side. Instead, the PDE and the finite speed $c$ cause any instantaneous injection at the point $\mathbf{x}_s(\tau)$ to produce an *outgoing spherical wave* whose wavefront moves outward at speed $c$. That is the built-in behavior of the wave equation.
* The Green’s function ensures that, at $(\mathbf{x},t)$, only the path history emission $q(\tau)$ with $\tau = t - r/c$ contributes, producing an outgoing spherical wave with amplitude $q(\tau)/(4\pi r)$ supported on $r=c(t-\tau)$. Thus Method 1 with $S(\mathbf{x},t)=q(t)\delta(\mathbf{x}-\mathbf{x}_s(t))$ naturally yields expanding shells at speed $c$.

**Why $v$ (emitter speed) doesn’t cause blow-ups**

* If the emitter slows or stops, $S(\mathbf{x},t)$ just keeps being nonzero at the same spatial location; the wave equation spreads each injection outward at speed $c$. No $1/|\mathbf{v}|$ singularity appears because you never converted from “per time” to “per distance.” You remain time-based.
* Numerically, represent the point delta by a small, smooth kernel if you want to avoid grid artifacts. Example: instead of $\delta(\mathbf{x}-\mathbf{x}_s)$ use a small Gaussian of width $\sigma$ comparable to grid spacing.

**Numerical recipe (simple)**

* Choose spatial grid $\mathbf{x}_i$ and time step $\Delta t$ satisfying CFL stability (roughly $c\Delta t/\Delta x \le \text{const}$).
* Use a standard finite-difference time stepping for the wave equation (centered difference in time and space).
* At each time step $t_n$ add the source contribution $S(\cdot,t_n)$ to the RHS at the grid cells nearest $\mathbf{x}_s(t_n)$. If the emitter stops, it remains injecting at that grid location — the solver propagates outgoing shells.
* To avoid a numerical spike, spread the delta over a few cells (mollifier) so you physically model a thin shell of finite thickness.

**Summary for Method 1**

* Model is explicit, straightforward, numerically robust.
* Emission is naturally time-based; shells expand automatically at speed $c$.
* No division by the emitter speed appears; stopping the emitter is handled simply by keeping the source at the same location.

---

# 2) Integral (Green’s function / retarded potential) approach

**Physical idea:** instead of evolving a PDE in time, write the solution as the sum of contributions from every past emission. For the wave equation the contribution from an impulse emitted at time $\tau$ and place $\mathbf{x}_s(\tau)$ arrives at a field point $\mathbf{x}$ only at the **retarded time** when the spherical shell reaches $\mathbf{x}$. The Green’s function neatly encodes the expanding shell.

### Fundamental formula (general)

If the wave equation is

$$
\frac{\partial^2 \phi}{\partial t^2} - c^2 \nabla^2 \phi = S(\mathbf{x},t),
$$

then the solution may be written as the space–time convolution with the Green’s function $G$:

$$
\boxed{\;\displaystyle \phi(\mathbf{x},t)
\;=\;
\iint G\big(\mathbf{x},t;\mathbf{y},\tau\big)\;S(\mathbf{y},\tau)\;d\tau\,d^3y\;}
$$

* $G(\mathbf{x},t;\mathbf{y},\tau)$ is the response at $(\mathbf{x},t)$ to an instantaneous unit impulse at $(\mathbf{y},\tau)$.

### The 3-D free-space wave Green’s function

For three spatial dimensions (the usual case for spherical shells), the causal Green’s function is

$$
G(\mathbf{x},t;\mathbf{y},\tau)
\;=\;
\frac{\delta\!\big(t-\tau - \tfrac{|\mathbf{x}-\mathbf{y}|}{c}\big)}{4\pi\,|\mathbf{x}-\mathbf{y}|},
\qquad t>\tau.
$$

**Interpretation:** a unit impulse at location $\mathbf{y}$ and time $\tau$ influences $\mathbf{x}$ at time $t$ only when the travel time $ |\mathbf{x}-\mathbf{y}|/c$ has elapsed; the $1/(4\pi r)$ factor is the usual geometric decay of an outgoing spherical wave in 3D.

### Plugging in a moving point source

If the emitter is a moving point source with a time-dependent source amplitude $q(\tau)$ at location $\mathbf{x}_s(\tau)$, then $S(\mathbf{y},\tau)= q(\tau)\,\delta(\mathbf{y}-\mathbf{x}_s(\tau))$. Plugging this into the convolution gives (integral over $\tau$ only):

$$
\boxed{\;\displaystyle
\phi(\mathbf{x},t) \;=\; \int_{-\infty}^{t}
\frac{q(\tau)\;
\delta\!\big(t-\tau - \tfrac{|\mathbf{x}-\mathbf{x}_s(\tau)|}{c}\big)}
{4\pi\,|\mathbf{x}-\mathbf{x}_s(\tau)|}\; d\tau\;}
$$

* $q(\tau)$ is the continuous emission density per unit time at the emission instant $\tau$. For a steady source, $q(\tau)=q_0$ (constant); more generally, $q$ may vary smoothly with $\tau$.

### Evaluating the integral — the retarded time

The $\delta$-function in the integrand enforces the *retarded-time condition*:

$$
t - \tau = \frac{r(\tau)}{c}, \qquad r(\tau)\equiv |\mathbf{x}-\mathbf{x}_s(\tau)|.
$$

So the contribution to $\phi(\mathbf{x},t)$ comes only from times $\tau$ such that the expanding spherical shell emitted at $\tau$ has just reached $\mathbf{x}$ at time $t$.

Mathematically, use the identity $\delta(g(\tau))=\sum_i \delta(\tau-\tau_i)/|g'(\tau_i)|$ where $\tau_i$ are simple roots of $g$. With $g(\tau)=t-\tau - r(\tau)/c$ we find (after algebra) the standard retarded solution:

$$
\boxed{\;
\phi(\mathbf{x},t) \;=\; \sum_{\tau_i}
\frac{q(\tau_i)}{4\pi\,r(\tau_i)\,\big|1 + \tfrac{1}{c}\,r'(\tau_i)\big|}
\;=\;
\sum_{\tau_i}
\frac{q(\tau_i)}{4\pi\,r(\tau_i)\,\big|1 - \tfrac{\mathbf{n}(\tau_i)\cdot\mathbf{v}_s(\tau_i)}{c}\big|}\;}
$$

where:

* the sum runs over **retarded times** $\tau_i$ solving $t-\tau_i=r(\tau_i)/c$ (usually there is a single relevant root).
* $r(\tau_i)=|\mathbf{x}-\mathbf{x}_s(\tau_i)|$.
* $r'(\tau)=\dfrac{d}{d\tau}|\mathbf{x}-\mathbf{x}_s(\tau)| = -\,\mathbf{n}(\tau)\cdot\mathbf{v}_s(\tau)$.
* $\mathbf{v}_s(\tau)=\dfrac{d\mathbf{x}_s}{d\tau}$ is the source velocity at emission time $\tau$.
* $\mathbf{n}(\tau) = \dfrac{\mathbf{x}-\mathbf{x}_s(\tau)}{r(\tau)}$ is the unit vector pointing from source (at emission) to the field point.

The factor $1 - \mathbf{n}\!\cdot\!\mathbf{v}_s/c$ (in the denominator) is a Doppler/retardation factor: if the source is moving toward the observer ($\mathbf{n}\!\cdot\!\mathbf{v}_s>0$) the denominator is smaller and the observed amplitude is boosted (intuitive: emitted shells catch up); moving away reduces amplitude. This is precisely the same structure that appears in Liénard–Wiechert potentials for moving charges.

### Special simple case — stationary emitter

If $\mathbf{x}_s(\tau)=\mathbf{x}_0$ (emitter fixed) and $q(\tau)=Q\,\delta(\tau-\tau_0)$ (single shell at $\tau_0$), then the formula reduces to the intuitive result:

* The field at $\mathbf{x},t$ is nonzero only when $t-\tau_0 = |\mathbf{x}-\mathbf{x}_0|/c$, i.e., when the spherical shell of radius $r=c(t-\tau_0)$ reaches $\mathbf{x}$.
* The amplitude is $\displaystyle \phi(\mathbf{x},t) = \frac{Q}{4\pi\,r}$ (no extra Jacobian factor because $v_s=0$).

### How shells show up here

* Each emitted shell corresponds to one emission time $\tau$. The delta in the Green’s function selects the observation times $t$ at which the shell reaches $\mathbf{x}$.
* The shape of the contribution is the $1/(4\pi r)$ geometric factor (for wave amplitude); the shell is “thin” in time if $q(\tau)$ is a delta in $\tau$, so you get a short impulse when the wavefront passes.

### Handling an emitter that stops / $|\mathbf v_s|\to 0$

* If the emitter slows or stops, the Jacobian factor $1 - \mathbf{n}\cdot\mathbf{v}_s/c$ tends to 1 and nothing singular happens. The retarded equation still has a solution and each shell arrives at the predicted time.
* If the emitter sits still and emits many shells (continuous $q(\tau)$), the field is the time integral (or sum) of all shell contributions evaluated at their respective retarded times. No $1/|\mathbf{v}_s|$ blowup occurs.

---

# Intuition: when to use which method

* **Method 1 (PDE)**: use this if you want to simulate the whole field over a spatial grid and time — e.g., visualize full 3D field, handle complicated background media (inhomogeneous $c$, damping), or include nonlinearities. Numerically straightforward: step the PDE forward, deposit source each time step. Very robust when the emitter stops or moves.

* **Method 2 (Green’s function / retarded integral)**: use this if you want closed-form expressions, analytic insight, or to compute the field at a few observation points (not the whole grid). This method gives the exact retarded formula and explicitly shows the “shell arrival condition” $t-\tau=|\mathbf{x}-\mathbf{x}_s(\tau)|/c$ and the Doppler-like Jacobian $1-\mathbf{n}\cdot\mathbf{v}_s/c$. For moving emitters it requires solving the retarded-time equation (root finding) for each observation point/time pair — cheaper if you have many emission events but few observers.

---

# Short worked example (stationary emitter, continuous source)

* Emitter at origin $\mathbf{x}_s=0$. Continuous source with $q(t)\equiv q_0$ (constant).
* From the retarded formula, the field at radius $r=|\mathbf{x}|$ and time $t$ is
  $$
  \phi(r,t) \;=\; \frac{q_0}{4\pi r},
  $$
  since the retarded condition selects $\tau = t - r/c$ and $q(\tau)=q_0$. If $q$ varies in time, then $\phi(r,t)=q(t-r/c)/(4\pi r)$.

---

# Practical implementation tips / numerical cautions

* **Always smear the delta** in numerical work: replace $\delta(\mathbf{x}-\mathbf{x}_s)$ by a small, normalized kernel of width $\sigma$ comparable to your grid spacing. This avoids grid-scale noise and models a physically finite shell thickness.
* **CFL condition** for wave PDE: choose $\Delta t$ so that $c \Delta t/\Delta x$ satisfies the stability bound for your discretization. If violated you'll get numerical instability.
* **Retarded solving (Method 2)** requires root-finding for $\tau$ from $t-\tau = r(\tau)/c$. For slowly moving emitters this is easy (one iteration), but if the source moves fast near $c$ the root finding and the denominator $1-\mathbf{n}\cdot\mathbf{v}_s/c$ require care (causality and relativistic effects arise if $|\mathbf{v}_s|$ approaches $c$).
* **If shells have finite thickness** in time, replace $\delta(t-\tau)$ by a smooth temporal profile. That makes the outgoing wavefront a pulse of finite duration rather than an idealized instant.

---

# Bottom line (in 3 sentences)

* Model the emitter as a time-based continuous emission density $q(\tau)$ at location $\mathbf{x}_s(\tau)$ (i.e., $S(\mathbf{x},t)=q(t)\,\delta\!\big(\mathbf{x}-\mathbf{x}_s(t)\big)$).
* Method 1 (solve the wave PDE with that source) is the easiest, robust way to get fields on a grid; the wave equation naturally produces expanding spherical shells at speed $c$.
* Method 2 (use the Green’s function / retarded integral) gives an analytic expression: each emission at time $\tau$ produces a contribution at $(\mathbf{x},t)$ only if $t-\tau = |\mathbf{x}-\mathbf{x}_s(\tau)|/c$; the observed amplitude includes the geometric $1/(4\pi r)$ decay and a Doppler/retardation factor $1-\mathbf{n}\cdot\mathbf{v}_s/c$.

---

# 3) Event-driven radial-transport + per-hit EOM (current canonical method)

Physical idea: represent emission as a conserved, razor-thin spherical shell (a measure on the sphere), then drive particle motion by summing purely radial per-hit accelerations at causal intersection times. We work in units with field speed $v=1$ unless noted; replace $v$ by $c$ otherwise.

Field representation (transport/continuity form)
- Source impulse at $(t_0,\mathbf{s}_0)$ creates a shell supported on $r = v(t-t_0)$ with surface density that conserves a constant per-shell amplitude $q$:
  $$
  \rho(t,\mathbf{s}) \;=\; \frac{q}{4\pi r^2}\,\delta\!\big(r - v(t-t_0)\big)\,H(t-t_0),\quad r=\|\mathbf{s}-\mathbf{s}_0\|.
  $$
- This solves the radial continuity (transport) equation
  $$
  \partial_t \rho + \nabla\!\cdot\!\big(v\,\hat{\mathbf{r}}\,\rho\big) \;=\; q\,\delta(t-t_0)\,\delta^{(3)}(\mathbf{s}-\mathbf{s}_0).
  $$
- Emission is continuous with constant time-density $q(t)\equiv q_0$.

Per-hit equation of motion (EOM)
- For a receiver $o'$ at time $t$ and a source $j$, causal emission times satisfy
  $$
  \|\mathbf{s}_{o'}(t) - \mathbf{s}_j(t_0)\| = v\,(t-t_0),\qquad t_0<t.
  $$
- Each root contributes a purely radial acceleration
  $$
  \mathbf{a}_{o'\leftarrow j}(t;t_0)
  \;=\;
  \kappa\,\sigma_{q_j q_{o'}}\,\frac{|q_j q_{o'}|}{r^2}\,\hat{\mathbf{r}},
  \quad
  \hat{\mathbf{r}}=\frac{\mathbf{s}_{o'}(t)-\mathbf{s}_j(t_0)}{r},\ r>0,
  $$
  with total acceleration the sum over sources and roots. Convention $H(0)=0$ removes the instantaneous self-kick at $\tau=0$. Optional mollification replaces $\delta(\cdot)$ by $\delta_\eta(\cdot)$ to produce smooth pushes.

Implementation checklist
- Root finding: solve $F(t_0;t)=\|\mathbf{s}_{o'}(t)-\mathbf{s}_j(t_0)\|-v(t-t_0)=0$ for all $j$ (including $j=o'$ for self-hits when kinematics permit).
- Accumulation: compute $r,\hat{\mathbf{r}}$, apply $1/r^2$, then superpose.
- Time stepping: impulsive mode (events) or mollified mode ($\eta>0$) with standard ODE integrators.
- Self-interaction: appears when the worldline outruns recent shells ($\|\mathbf{v}\|>v$ for some emissions); self-hits are repulsive (like-on-like).

Relation to Methods 1 and 2
- This is a transport/continuity model, not the scalar wave equation. The $1/r^2$ factor is a surface-density normalization (Gauss-like on moving spheres); it is compatible with conserving total emission per shell. In Method 2 the $1/(4\pi r)$ factor appears for a wave amplitude; taking gradients connects these scalings when mapping to forces.
- The Doppler-type Jacobian $1-\mathbf{n}\!\cdot\!\mathbf{v}_s/c$ from Method 2 is not explicit here; geometric normalizations are absorbed into $\kappa$ by convention. If desired, include an extra per-hit weighting by this Jacobian to align magnitudes with retarded-integral predictions; otherwise geometry and timing alone encode speed effects.
- Numerically, this method targets particle dynamics directly (per-hit ODEs) rather than evolving a full field (Method 1) or evaluating fields at sparse probes (Method 2).

Plain language: Treat the field as razor-thin “paint” spread over a growing sphere so the total amount stays the same. Every time a shell reaches you, you get a straight-line shove that falls off like one over distance squared; we either treat it as a sharp kick or a short, smooth nudge.

---

## Pros and cons (comparative)

Method 1 — Time-based PDE (wave equation)
- Pros
  - Physically standard propagation at fixed speed $c$; expanding spheres emerge automatically.
  - Robust on grids; handles inhomogeneous media, damping, and boundaries.
  - Good for full-field visualization and energy bookkeeping in continuum form.
- Cons
  - Computationally heavy for many-particle dynamics (3D grids, CFL constraints).
  - Requires careful numerics to avoid dispersion/reflection; mesh choices can bias results.
  - Mapping grid fields to the radial-only per-hit ODE can add another modeling layer.

Method 2 — Retarded Green’s function (integral)
- Pros
  - Exact in homogeneous free space; no grid or time stepping for the field.
  - Makes causality explicit via retarded times; captures Doppler/Jacobian $1-\mathbf{n}\!\cdot\!\mathbf{v}_s/c$ automatically.
  - Efficient when you need the field at a few observation points; excellent for analysis and cross-checks.
- Cons
  - Requires root-finding for each (observer, time) pair; multiple roots possible when sources outrun shells.
  - Costly when many receivers/sources are present; bookkeeping grows quickly.
  - Needs careful handling near tangencies (small Jacobians) and in multi-hit/self-hit regimes.

Method 3 — Event-driven radial-transport + per-hit EOM (current canonical)
- Pros
  - Directly implements the project’s delayed, radial-only interaction law with constant emission cadence.
  - Natural support for self-hits and superposition; local $1/r^2$ weighting makes near sources dominate.
  - Numerically lightweight for particle dynamics; works cleanly with impulsive or mollified ODE integration.
- Cons
  - Not derived from the scalar wave equation; global field-energy accounting is indirect (via mollified potentials).
  - Omits the explicit retarded-time Jacobian factor from Method 2; relies on $\kappa$ calibration (or optional Jacobian weighting).
  - Accuracy depends on robust causal-root finding and regularization choices in complex multi-hit scenarios.

---

## Recommendation (going forward)

- Use Method 3 as the primary engine for particle dynamics and assemblies. It matches the model’s axioms (radial-only action, constant emission cadence) and scales well.
- Adopt Method 2 as the analytic reference for calibration and validation. Calibrate $\kappa$ so simple benchmarks (stationary/slow sources, symmetric binaries) agree between Methods 2 and 3 at the per-hit level; optionally include the retarded-time Jacobian per hit if strict alignment with Method 2 is required.
- Reserve Method 1 for full-field studies (visualization, media, boundary effects) and for end-to-end tests of numerical stability; it is valuable but unnecessary for routine ODE-based assembly simulations.
- Documentation/actionables: keep the continuity-form field definition and per-hit EOM as the canonical statement; add a brief appendix mapping densities (Method 3) to potentials (Method 2) to clarify when $1/r$ vs $1/r^2$ factors appear and how calibration preserves totals.

Plain language: Keep using the event-driven, radial-only method for dynamics, check it against the retarded integral to set the knobs, and bring out the PDE only when you need whole-field pictures or complex media.

---

# Layered penetration diagram (molecules → cores)

A qualitative “onion” sketch to visualize which excitations typically penetrate which structural layers. This helps readers see what’s excluded and what isn’t.

Legend: [+] passes, [~] depends (energy/frequency/geometry), [x] mostly blocked/strongly attenuated

```
+===============================================================+
| L4: Bulk molecular shell (solids/liquids; many-body opacity)  |
|   Photons:        [~] (material window; optical opaque, IR/UV/X/γ vary)   |
|   Neutrinos:      [+] (nearly transparent)                                 |
|   Charged ±ε:     [x] (bind/deflect; do not traverse as free particles)    |
|   Dark-matter-like neutral (hypothetical): [+] (very weak coupling)        |
+---------------------------------------------------------------+
| L3: Atomic electron cloud (bound electrons)                    |
|   Photons:        [~] (photoelectric/Compton; X/γ penetrate better)        |
|   Neutrinos:      [+]                                                     |
|   Charged ±ε:     [x] (Coulomb-coupled; captured/scattered)                |
|   Dark-matter-like neutral: [+]                                           |
+---------------------------------------------------------------+
| L2: Nuclear layer (nucleons; femtoscopic scale)                |
|   Photons:        [~] (γ can interact; strong attenuation in bulk)         |
|   Neutrinos:      [+] (weak interaction; mostly pass)                      |
|   Charged ±ε:     [x] (excluded as free traversers)                        |
|   Dark-matter-like neutral: [+]                                           |
+---------------------------------------------------------------+
| L1: Noether Core shielding (triply nested binaries; shielded)  |
|   Photons:        [x] (far-field cancels; no corridor capture)             |
|   Neutrinos:      [~] (tiny axial coupling only)                           |
|   Charged ±ε:     [x] (self/partner couplings dominate; no transit)        |
|   Dark-matter-like neutral: [+] (by hypothesis: minimal coupling)          |
+---------------------------------------------------------------+
| L0: Axial corridors / flux-tube loci (coherent geometry)       |
|   Photons:        [+] (guided along corridor)                               |
|   Neutrinos:      [~] (weak corridor coupling; alignment matters)           |
|   Charged ±ε:     [x] (no cross-product forces; not a transit channel)      |
|   Dark-matter-like neutral: [~] (minimal, geometry-dependent)               |
+===============================================================+
```

Notes (interpretation):
- “Dark-matter-like neutral” denotes very weakly coupled, neutral meta-assemblies consistent with this framework; included here as a hypothesis for qualitative comparison.
- Entries marked [~] depend on spectrum, thickness, coherence, and alignment (e.g., γ vs optical photons; corridor alignment for neutrinos).
- The diagram is about penetration (transit). Local interactions, capture, or re-binding are separate processes governed by geometry and delay.



